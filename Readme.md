# Форум
Клиент-серверное приложение, позволяющее создавать темы для обсуждения с другими людьми.

# Протокол
Состав пакета
```
|                                 HEADER                                     |
|-- 1 bit  --|- 7 bits -|-- 4 bytes --|--  4 bytes  --|- 4 bytes -|== .... ==|
|-- source --|-- type --|---- cid ----|-- data size --|--  tid  --|== DATA ==|

source:
1 - server
0 - client

type:
register         = 0
authentication   = 1
get_topics       = 2
get_messages     = 3
add_topic        = 4
add_message      = 5
get_online_users = 6

cid - уникальный id клиента
data size - число блоков DATA
tid - id темы форума
```

Заголовок `DATA`
```
       |                                    DATA                                         |
       |-- dtype --|-- 8 bytes --|-- 4 bytes --|-- n bytes --|-- 4 bytes --|-- m bytes --|
TUPLE  |     0     |    time     |--  size1  --|--  text1  --|--  size2  --|--  text2  --|
RANGE  |     1     | from |  to  |--    0    --|--         --|--    0    --|--         --|
STATUS |     2     |    status   |--    0    --|--         --|--    0    --|--         --|

STATUS
OK = 0
PERMISSION_ERROR = 1 недостаточно прав
AUTHENTICATION_ERROR = 2 oшибка авторизации
REGISTRATION_ERROR = 3 ошибка регистрации
FORMAT_ERROR = 4 пустое название топика / пустое сообщение
```

Всевозможные виды запросов и ответов
```
Клиент
| SRC | TYPE | CID | SIZE | TID |  DATA   |
|  0  | 0000 | *** | 0001 | *** |  TUPLE  | регистрация text_1 = login, text_2 = password
|  0  | 0001 | *** | 0001 | *** |  TUPLE  | авторизация text_1 = login, text_2 = password
|  0  | 0010 | cid | 0001 | *** |  RANGE  | получение списка топиков
|  0  | 0011 | cid | 0001 | tid |  RANGE  | получение списка сообщений
|  0  | 0100 | cid | 0001 | *** |  TUPLE  | добавление нового топика
|  0  | 0101 | cid | 0001 | tid |  TUPLE  | добавление нового сообщения
|  0  | 0110 | cid | 0000 | *** |  NULL   | получение списка участников

Сервер
|  1  | 0000 | cid | 0001 | *** | STATUS  | регистрация
|  1  | 0001 | cid | 0001 | *** | STATUS  | авторизация
|  1  | 0010 | cid | size | *** | TUPLE.. | возврат списка топиков
|  1  | 0011 | cid | size | tid | TUPLE.. | возврат списка сообщений
|  1  | 0100 | cid | 0001 | tid | STATUS  | добавление нового топика
|  1  | 0101 | cid | 0001 | tid | STATUS  | добавление нового сообщения
|  1  | 0110 | cid | size | *** | TUPLE.. | возврат списка участников
```

При создании нового топика и сообщения клиентом, текст может находится либо в `text1`, либо в `text2`.
При возврате списка участников сервером ник участников находится либо в `text1`, либо в `text2`.

При возврате сообщения сервером автор сообщения находится в `text1`, текст сообщения в `text2`.
При возврате темы форума сервером автор находится в `text1`, название топика в `text2`.

`tid` - индивидуальный номер темы. `tid` нового топика = `tid` + 1 последнего топика.
`cid` - индивидуальный номер сессии клиента - случайное уникальное положительное число.
При каждом новом входе клиента сервером назначается `cid`, которое может отличаться при последующей авторизации.

`tid`, `cid`, `size` - беззнаковые 4-байтовые числа
`time` - беззнаковое 8-байтовое число секунд с момента `unix epoch`, выставляется сервером.
Для запросов, где время не требуется, значение `time` не специфицировано.

`cid` при `STATUS != ОК` может быть любым, клиенту нельзя использовать `cid` при ошибках в статусе в запросах авторизации и регистрации.
Для указания всех топиков/сообщений клиент может запросить `from` = `0x0`, `to` = `0xFFFF`. Сервер не должен выдавать
ошибки при выходе за пределы id сообщений и топиков. При отсутствии в запрашиваемом диапазоне сообщений/топиков выдавать `size` = 0

# Клиент
Подготока к запуску клиента
```bash
pip install -r requirements.txt
```

Запуск клиента
```bash
python3 client.py --ip <ip> --port <port>
```

# Сервер
